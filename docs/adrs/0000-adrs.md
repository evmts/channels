# ADR-0000: Architectural Decision Records

<adr-metadata>
**Status:** Accepted | **Date:** 2025-01-08 | **Deciders:** Core | **Related:** None | **Phase:** All
</adr-metadata>

## Context

<context>
Complex state channel system needs documenting WHY decisions made (not just what): preserve context, enable informed changes, facilitate discussion, create accountability.

**Problem:** Trad docs capture "what" lose "why". Requirements/specs/comments â‰  options/trade-offs/constraints. Need: lightweight (actually done), sufficient context (useful later), versioned (with code), integrated (workflow).
</context>

## Decision

<decision>
**Use ADRs** for significant arch/design decisions.

**ADR:** Context+problem, options, decision+why, consequences
**Store:** `/docs/adrs/` | **Number:** Sequential from 0001 | **Format:** MD template | **Version:** Git | **Immutable:** Once accepted (new supersede) | **Review:** With code
</decision>

## What/When/How

<what>
**ADR:** 1 decision + context + consequences
**Traits:** 1 decision/ADR, immutable, numbered, contextual, versioned
**Lifecycle:** Proposedâ†’Acceptedâ†’{Deprecated|Superseded}
**Good:** Context, multiple opts, clear decision, pros+cons, concise (1-3pg), simple, examples
**Bad:** No context, 1 opt, too long, jargon, after-fact, hide downsides
</what>

<when>
**Write for:** Architecture (system/modules/dataflow), tech (lang features/libs/DB/crypto), protocols (API/msg formats/wire), process (testing/build/deploy/version), performance (cache/optimization)

**Skip:** Implementation details, obvious choices, temp code, bug fixes (unless arch), formatting (use linters)

**Rule:** Multiple smart people could disagree? â†’ ADR. One obvious way? â†’ No ADR.
</when>

<how>
**Steps:** 1) Copy template 2) Fill metadata 3) Context (2-3Â¶) 4) Drivers (top 3-5) 5) Options (2-4: desc/pros/cons/code/effort) 6) Decision (what+why) 7) Consequences (pos/neg/mitigate) 8) Implementation (structure/tests/docs/migration) 9) Review (draftâ†’feedbackâ†’discussâ†’updateâ†’Accepted) 10) Implement (reference `// ADR-XXX`, commits, update status)

**Naming:** `NNNN-short-title.md` (4 digits, sequential, no gaps/reuse)
</how>

## Status & Workflow

<status>
|Status|When|
|--|--|
|Proposed|Draft, not agreed|
|Accepted|Consensus, ready implement|
|Deprecated|Outdated/wrong, not replaced|
|Superseded|Newer ADR replaced|

**Transitions:** Proposedâ†’Accepted/Deprecated, Acceptedâ†’Deprecated/Superseded
**Update:** âœ… Status change, changelog, "Superseded by" link | âŒ Edit decision (new ADR), delete deprecated, change dates
</status>

<workflow>
**Before Code:**
```
Prerequisites:
- [ ] ADR-0042 written+approved
- [ ] Begin implement
```

**During:**
```zig
// Based ADR-0042
pub fn foo(...) {...}
```

**Commits:**
```
feat: snapshot opt

Impl ADR-0042. Snap/1000ev LZ4 compress.
See: docs/adrs/0042-snapshot.md
```

**PRs:** List ADRs: âœ… Implemented, ğŸ”„ In progress

**Change:** New ADR "Supersedes ADR-XXX"â†’Update old "Superseded by ADR-YYY"â†’Changelog both
</workflow>

## Benefits/Practices

<benefits>
**Now:** Better decisions (write forces clarity), alignment, less bike-shed, knowledge share
**Later:** Context preservation, safe changes, avoid repetition, historical record
**Onboard:** Quick understand, see evolution, trade-offs, informed contributions
</benefits>

<best-practices>
**DO:** âœ… Before implement, concise, multiple opts, pros+cons, simple, examples, ref in code, update index
**DON'T:** âŒ Edit accepted (new instead), after-fact, too long, 1 opt, hide negatives, jargon, drift
**Tips:** Start small, template=guide, involve team, link liberally, review regularly
</best-practices>

## Structure

<structure>
```
docs/adrs/
â”œâ”€â”€ 0000-adrs.md (this)
â”œâ”€â”€ 0001-event-sourcing.md
â”œâ”€â”€ ...
â””â”€â”€ README.md (index: list/status/summary âœ…ğŸ”„âš ï¸)
```
</structure>

## Validation

<validation>
**Success:** ADRs for major decisions, team refs in discussions, contributors find helpful, fewer "why?" Qs
**Review:** 6mo (process), 12mo (quality/usage)
**Improve if:** Too heavy, decisions not doc'd, not maintained, better tool emerges
</validation>

## Refs

<references>
- Nygard: cognitect.com/blog/2011/11/15/documenting-architecture-decisions
- ADR org: adr.github.io
- go-nitro: `/go-nitro/.adr/`
</references>

<changelog>
- 2025-01-08: Initial (Accepted)
</changelog>
